\chapter{*Differenciálegyenletek alapjai}

\setcounter{footnote}{0}

\section{Követelmények}
\begin{enumerate}
    \item Differenciálegyenlet (rendszer) fogalma, kezdetiérték-probléma (Cauchy-feladat)
    \item Egzakt egyenlet
    \item Szeparábilis egyenlet
    \item Rakéta emelkedési idejének kiszámítása
\end{enumerate}

\section{Differenciálegyenletek}

\begin{definition}[differenciálegyenlet]\label{def:de}
Legyen $1 \le n \in \N$ és $I \subset \R$ és $\Omega \subset \R^n$ nyílt intervallumok.\footnote{
Itt mondhatnánk, hogy $\Omega$ szempontjából elég azokkal az esetekkel foglalkozni, ahol egy kicsit szigorúbb feltételt teljesít: $\Omega$ egy $\R^n$-beli tartomány. Azonban azt megadni, hogy ez mit is jelent, új topológiai fogalmakat használna, ezért ezt a segédanyag is mellőzi. A könyv azonban részletesebb kifejti ezeket, így ha lesz rá időm, készítek neki egy bekezdést a függelékben. % TODO
} Tegyük fel, hogy az $f : I \times \Omega \to \R^n$ függvényre $f \in C$ teljesül.
Ekkor a feladat:

Határozzunk meg olyan $\varphi \in I \to \Omega$ függvényt, amire
\begin{enumerate}[label=(\alph*),itemsep=1pt,topsep=1pt]
    \item $\dom_\varphi$ nyílt intervallum
    \item $\varphi \in D$
    \item $\varphi'(x) = f(x,\,\varphi(x)) \quad (x \in \dom_\varphi)$
\end{enumerate}

Ezt a feladatot hívjuk \textbf{explicit elsőrendű közönséges differenciálegyenletnek} (röviden \textbf{differenciálegyenletnek}), és bevezetjük rá a \emph{d.e.} rövidítést.
\end{definition}

\begin{remarks}
\
\begin{enumerate}[label=\roman*),itemsep=1pt]
    \item Minden, a fenti feltételeket kielégítő $\varphi$ függvény a d.e. \textbf{megoldása}.
    \item Az $f$ függvény pedig a d.e. \textbf{jobb oldala}.
    \item Ha $\varphi$ egy megoldás, minden $J \subset \dom_\varphi$ nyílt intervallumon vett $\restrict \varphi J$ leszűkítés is megoldás.
    \item Az $\R \times \R^n \equiv \R^{n+1}$ azonosítás miatt az $f$ mint egy $\R^{n+1} \to \R^n$ leképezés, azaz $n+1$ változós vektorfüggvényként is felfogható, mivel $I \times \Omega \subset \R^{n+1}$.
    \item Az elnevezésben a \emph{közönséges} azt jelenti, hogy egyváltozós függvényt keresünk (nincsenek parciális deriváltak), az \emph{elsőrendű} azt, hogy nincsen elsőnél magasabb rendű deriváltra feltételünk, az \emph{explicit} pedig azt, hogy a deriváltra nézve van kifejezve a feltétel.
    \item Az \emph{implicit} alaknál $f$ helyett veszünk pl. egy $F : I \times \Omega \times \R^n \to \R^n,\ F \in C$ függvényt és $F(x,\,\varphi(x),\,\varphi'(x))=0$ formában adjuk meg a feltételt.
\end{enumerate}

\end{remarks}

\begin{definition}[kezdetiérték-probléma]
Ha adott $\tau \in I,\ \xi \in \Omega$ mellett kikötjük még $\tau \in \dom_\varphi$ és $\varphi(\tau) = \xi$ feltételeket is, akkor \textbf{kezdetiérték-problémának} hívjuk a feladatot (vagy \textbf{Cauchy-feladatnak}), és \emph{k.é.p.}-nek rövidítjük.
\end{definition}

\begin{definition}[differenciálegyenlet rendszer]
A \ref{def:de} definícióban legyen $n \ge 2$.

Ekkor $\varphi = (\varphi_1, \ldots, \varphi_n)$ és $f = (f_1, \ldots, f_n)$.
$$\varphi'(x) = f(x, \varphi(x)) \eqv \varphi_i'(x) = f_i(x, f_1(x), f_2(x), \ldots, f_n(x)) \quad (x \in \dom_\varphi)$$

Ilyenkor \textbf{differenciálegyenlet rendszerről} beszélünk, \emph{d.e.r.}-nek rövidítjük.

Tehát a differenciálegyenlet rendszerek a differenciálegyenlet feladat $n \ge 2$ esetei.
\end{definition}

\subsection{Teljes megoldás}

\subsubsection{Felvezető példa}

A \ref{def:de} definícióban legyen $n := 1,\ I := \Omega := \R$. Vizsgáljuk ekkor az $f(x,y) := \sqrt{|y|} \quad \big((x,y) \in \R\big)$ jobb oldallal rendelkező $\tau := \xi := 0$ k.é.p.-et.

Olyan nyílt $\dom_\varphi$ intervallumon értelmezett $\varphi \in \R \to \R$ függvényt keresünk tehát, amire $\varphi \in D$ teljesül, $\varphi(0) = 0$, és
$$\varphi'(x) = f(x,\varphi(x)) = \sqrt{|\varphi(x)|} \quad \big((x,y) \in \dom_\varphi\big)$$

Ekkor $\varphi \equiv 0$ egy megoldása a differenciálegyenletnek.

De ugyanakkor a következő, lényegesen különböző $\tilde\varphi$ függvény is:
$$\tilde\varphi(x) := \begin{cases}
    \dfrac {x^2} 4 & (x \ge 0) \\[8pt]
    -\dfrac {x^2} 4 & (x < 0)
\end{cases}$$

Tehát a fenti k.é.p. nem oldható meg egyértelműen.

\begin{definition}[teljes megoldás]
Egy kezdetiérték-probléma \textbf{egyértelműen oldható meg}, ha tetszőleges $\varphi, \tilde\varphi$ megoldásokra
\begin{equation}\label{eq:kep-uni-sol-eqv}
\varphi(x) = \tilde\varphi(x) \qquad (x \in \dom_\varphi \cap \dom_{\tilde\varphi}).
\end{equation}

Legyen ekkor $\mathcal M$ a k.é.p. megoldásainak halmaza és
\vspace{-3pt}
$$J := \bigcup_{\varphi \in \mathcal M}\dom_\varphi$$

Ekkor $J\ (\subset I)$ nyílt\footnote{Ld. \emph{Analízis III., nyílt halmazok uniója}.}, valamint a $\tau \in \dom_\varphi$ k.é.p. feltétel és \eqref{eq:kep-uni-sol-eqv} miatt $\tau \in J$ is teljesül.

Legyen $\Phi : J \to \R : \Phi(x) := \varphi(x) \enspace (x \in J, \varphi \in \mathcal M)$. Ez tetszőleges $\varphi$-vel megadható \eqref{eq:kep-uni-sol-eqv} miatt.

Ekkor szintén \eqref{eq:kep-uni-sol-eqv} és a k.é.p. feltételei szerint $\Phi(\tau) = \xi,\ \Phi \in D,$ és $\Phi'(x) = f(x,\Phi(x)) \enspace (x \in J)$.

Vagyis $\Phi \in \mathcal M$ és minden $\varphi \in \mathcal M$-re $\varphi(x) = \Phi(x) \enspace (x \in \dom_\varphi) \eqv \varphi = \restrict \Phi {\dom_\varphi}$.

Tehát a k.é.p. bármely megoldása megadható $\Phi$ egy leszűkítéseként.

Ekkor a $\Phi$ függvényt a kezdetiérték-probléma \textbf{teljes megoldásának} nevezzük.
\end{definition}

\section{Szeparábilis differenciálegyenletek}

\begin{definition}[szeparábilis differenciálegyenlet]
Legyen $n := 1$ és $I,J \subset \R$ nyílt intervallumok. Legyen továbbá $g : I \to \R,\ h : J \to R \setminus \{0\}$, amikre $g, h \in C$.

Tekintsük ekkor a $f(x,y) := g(x) \cdot h(x) \quad \big((x,y) \in I  \times J\big)$ jobb oldallal rendelkező differenciálegyenletet. Ekkor olyan $\varphi \in I \to J$ megoldást keresünk, amire
\begin{equation}\label{eq:sep-de-def}
\varphi'(x) = g(x) \cdot h(\varphi(x)) \qquad (x \in \dom_\varphi)
\end{equation}

Az ilyen alakban megadható differenciálegyenlet feladatot hívjuk \textbf{szeparábilis differenciálegyenletnek} (vagy \textbf{szétválasztható változójú differenciálegyenletnek}).

Legyenek adottak $\tau \in I,\ \xi \in J$ számok, amikre $\tau \in \dom_\varphi$ és $\varphi(\tau) = \xi$.

Ekkor egy \emph{szeparábilis differenciálegyenletre vonatkozó kezdetiérték-problémával} van dolgunk.\footnote{Az egyszerűség kevéért a jegyzet során ezekre röviden csak \emph{szeparábilis k.é.p.}-ként hivatkozok, de ez nem egy formális fogalom. Hasonlóan az egzakt d.e.-re vonatkozó k.é.p.-ekre pedig egzakt k.é.p.-ként, és így tovább.}
\end{definition}

\begin{theorem}[szeparábilis k.é.p. megoldás egyértelműsége]\label{sec:sep-uni}
\

Tetszőleges szeparábilis differenciálegyenletre vonatkozó kezdetiérték-probléma egyértelműen megoldható, és minden $\psi, \varphi$ megoldásaira:
\[\varphi(x) = \psi(x) \qquad (\dom_\varphi \cap \dom_\psi)\]
\end{theorem}
\begin{proof}\footnote{A követelmények között nem szerepel expliciten ez a bizonyítás, de a rakéta feladatra, mint szeparábilis k.é.p.-re adott megoldása a segédanyagnak a bizonyítás során bevezetett jelölésekre és egyenlőségekre hivatkozik, így kidolgoztam.}
A definícióban szereplő szimbólumokat értelmezzük itt is ugyanúgy.

Mivel bármely $x \in J$-re $h(x) \ne 0$, egy $\varphi$ megoldással a \eqref{eq:sep-de-def} egyenlőség átrendezhető $g$-re, vagyis
\begin{equation}\label{eq:sep-uni-proof-start}
\frac {\varphi'(x)} {h(\varphi(x))} = g(x) \quad (x \in \dom_\varphi)
\end{equation}

ahol $\dom_\varphi \subset I$ nyílt intervallum.

Mivel $g$ és $\dfrac 1 h$ nyílt intervallumon értelmezett ($\dom_g = I$ és $\dom_{1/h}=J$), folytonos függvények, így megadható egy primitív függvényük, tehát
$$\exists G : I \to \R,\ H : J \to \R \text{ amikre } G,H \in D \text{ és } G' = g, H' = \frac 1 h$$

Az összetett függvények deriváltja ($(H \circ \varphi)'(x) = H'(\varphi(x)) \cdot \varphi'(x)$) alapján \eqref{eq:sep-uni-proof-start} azt jelenti, hogy
$$(H \circ \varphi)'(x) = \frac {\varphi'(x)}{h(\varphi(x))} = g(x) = G'(x) \quad (x \in \dom_{\varphi})$$

Vagyis valamilyen $c \in \R$-vel,
$$(H \circ \varphi - G)'(x) = 0 \implies (H \circ \varphi - G)(x) = c \qquad (x \in \dom_\varphi)$$

Ekkor spec. $x := \tau$ esetben $H(\varphi(\tau)) - G(\tau) = H(\xi) - G(\tau) = c$.
Tehát,
\begin{equation}\label{eq:sep-uni-proof-hg-cond}
H(\varphi(x)) - G(x) = H(\xi) - G(\tau) \qquad (x \in \dom_\varphi)
\end{equation}

Vagyis \emph{ha léteznek} megoldások, akkor a fenti egyenlőség teljesül rájuk. Lássuk be, hogy valóban mindig lesz megoldása a feladatnak.

\paragraph*{Létezés.}

Definiáljuk az $F : I \times J \to \R,\ F(x,y) := H(y) - G(x) - H(\xi) + G(\tau)$ függvényt. Erre $F \in C^1$ és $F(\tau, \xi) = 0$ teljesülnek. Továbbá
$$\partial_2F(\tau, \xi) = H'(\xi) = \dfrac 1 {h(\xi)} \ne 0$$

Tehát $F$-re alkalmazható az \emph{implicitfüggvény-tétel} a $(\tau, \xi)$ pontban.

A tétel alapján $\exists K(\tau),\,K(\xi),\, \varphi : K(\tau) \to K(\xi)$ implicitfüggvény, amire $\varphi \in C^1$ és
$$\varphi'(x) = -\frac{\partial_1 F(x,\,\varphi(x))}{\partial_2 F(x,\,\varphi(x))} = -\frac {-G'(x)} {H'(\varphi(x))} = g(x) \cdot h(\varphi(x)) \qquad (x \in K(\tau))$$

teljesülnek. Továbbá szintén a tétel miatt $\varphi(\tau) = \xi$.

Ekkor tehát $\varphi$ egy megoldás.\partqed

\vspace{-2pt}
\paragraph*{Egyértelműség.}

Emlékezzünk, hogy tetszőleges $\tilde\varphi$ megoldásnak teljesíteni kell a \eqref{eq:sep-uni-proof-hg-cond} feltételt, valamilyen $G = g'$ és $H' = \dfrac 1 h$ primitív függvényekre.

\emph{Ötlet:} Mivel a \eqref{eq:sep-uni-proof-hg-cond} feltételnek mindenképpen teljesülnie kell, lássuk be, hogy az összes ilyen primitív függvény $\varphi$-hez fog vezetni.

Tegyük fel, hogy $\tilde H, \tilde G$ is megfelelő primitív függvények és $\tilde \varphi : \tilde K(\tau) \to \tilde K(\xi)$ egy megoldás, amire
$$\tilde H(\tilde \varphi(x)) - \tilde G(x) = \tilde H(\xi) - \tilde G(\tau) \qquad (x \in \dom_{\tilde\varphi})$$

Viszont $\exists \alpha, \beta \in \R : \tilde H = H + \alpha,\ \tilde G = G + \beta$.\footnote{
Ld. \emph{Analízis II., Primitív függvények (alap)tulajdonságai}
}
Tehát bármely $x \in \dom_{\tilde\varphi}$-re,
\begin{align}
H(\tilde\varphi(x)) + \alpha - G(x) - \beta &= H(\xi) + \alpha - G(\tau) - \beta \label{eq:sep-uni-wincon} \\
H(\tilde\varphi(x)) - G(x) &= H(\xi) - G(\tau) \notag
\end{align}

Tudjuk, hogy $H'(y) = \dfrac 1 {h(y)} \ne 0 \enspace (y \in J)$. Továbbá, mivel $H'$ egy deriváltfüggvény, így Darboux-tulajdonságú is.\footnote{
Ld. \emph{Analízis II., Darboux-tétel}
} Sőt, mivel nem veszi fel a $0$ értéket sehol, tudjuk, hogy állandó előjelű.\footnote{
Ui. a Darboux-tulajdonság (informálisan) azt garantálja, hogy a függvény bármely két értéke között felveszi az összes köztes értéket. Emiatt, ha előjelet váltana valahol $H'$, akkor fel kéne vennie ehhez a $0$-t is valahol.
} Ez alapján viszont $H$ szigorúan monoton\footnote{Ld. \emph{Analízis II., Monotonitás és derivált kapcsolata}}, és így invertálható is. Ekkor viszont \eqref{eq:sep-uni-proof-hg-cond} és \eqref{eq:sep-uni-wincon} egyenlőségek alapján:
\begin{alignat*}{4}
    & \varphi(x) && = H^{-1}(G(x) + H(\xi) - G(\tau)) \qquad && (x \in \dom_\varphi) \\
    & \tilde\varphi(x) && = H^{-1}(G(x) + H(\xi) - G(\tau)) \qquad && (x \in \dom_{\tilde\varphi}) \\
\implies & \varphi(x) && = \tilde\varphi(x) \qquad && (x \in \dom_\varphi \cap \dom_{\tilde\varphi})
\end{alignat*}

Tehát bármely $\tilde\varphi$ megoldás azonos lesz $\varphi$-vel $\dom_{\varphi} \cap \dom_{\tilde\varphi}$ leszűkítésen.
\end{proof}

\begin{remark}[Szeparábilis differenciálegyenlet megoldása integrálfüggvénnyel]
\

Vizsgáljuk meg a szeparábilis differenciálegyenletek megoldásában központi szerepet élvező \eqref{eq:sep-uni-proof-hg-cond} egyenlőséget. Ez átrendezhető a következő módon:
\begin{align*}
H(\varphi(x)) - G(x) &= H(\xi) - G(\tau) \qquad (x \in \dom_\varphi) \implies \tag{\ref{eq:sep-uni-proof-hg-cond}} \\
H(\varphi(x)) - H(\xi) &= G(x) - G(\tau) \qquad (x \in \dom_\varphi)
\end{align*}

Vegyük észre, hogy mivel $H,G$ primitív függvények, így ez a Newton-Leibniz tétel szerint felbontott alakja a következő integrálfüggvény egyenlőségnek:
\begin{equation*}
    \int^{\varphi(x)}_\xi \frac 1 {h(x)}\, dx = \int_\tau^x g(x)\,dx \qquad (x \in \dom_\varphi)
\end{equation*}

Vagyis általánosan a két integrál kiszámításával kapott egyenlőségből is megoldható a feladat.
\end{remark}

\section{Egzakt differenciálegyenletek}

\begin{definition}[egzakt differenciálegyenlet]
Legyenek $I, J \subset \R$ nyílt intervallumok és $g : I \times J \to \R,\ h : I \times J \to \R$ olyan függvények, amire $g,h \in C$, valamint $0 \notin \rng_h$. Olyan $\varphi : I \to J,\, \varphi \in D$ megoldást keresünk, amire $\dom_\varphi \subset I$ nyílt, és
$$\varphi'(x) = -\frac{g(x,\varphi(x))}{h(x,\varphi(x))} \qquad (x \in \dom_\varphi)$$

Egy így megfogalmazott feladat \textbf{egzakt differenciálegyenlet} akkor, \emph{ha}
$$I \times J \ni (x,y) \mapsto \big(g(x,y),\ h(x,y)\big) \in \R^2$$
leképezésnek van primitív függvénye.

Ez azt jelenti, hogy egy alkalmas $G : I \times J \to \R$ függvénnyel,
$$\grad G = (\partial_1\, G,\ \partial_2\, G) = (g,h)$$

Ha $\varphi$ függvénytől azt is elvárjuk, hogy valamilyen $\tau \in I,\ \xi \in J$ értékekre $\tau \in \dom_\varphi$ és $\varphi(\tau) = \xi$, akkor a feladatot egy \emph{egzakt differenciálegyenletre vonatkozó kezdetiérték-problémának} nevezzük.
\end{definition}

\begin{theorem}[egzakt k.é.p.-ek megoldhatósága]
\

Minden egzakt differenciálegyenletre vonatkozó kezdetiérték-probléma megoldható, és minden $\psi, \varphi$ megoldásaira:
$$\varphi(x) = \psi(x) \qquad (x \in \dom_\varphi \cap \dom_\psi)$$
\end{theorem}
\begin{proof}
    Mivel a követelményben még annyira sincs benne, mint a szeparábilis k.é.p.-ek megoldhatósága, így itt nem bizonyítjuk.
    Ld. segédanyag.
\end{proof}

\subsection{Szeparábilis és egzakt differenciálegyenletek kapcsolata}

Minden szeparábilis differenciálegyenlet átrendezhető egzakt alakba.

Véve a $\varphi'(x) = g(x)\cdot h(\varphi(x))$ szeparábilis d.e. feladatot, az
\vspace{-10pt}
$$\varphi'(x) = g(x) \cdot h(\varphi(x)) = -\dfrac{-g(x)}{1/h(\varphi(x))} \qquad (x \in \dom_{\varphi})$$
átírással kapott alak egy \emph{egzakt differenciálegyenlet} lesz.

\subsection{Szükséges feltétel ``egzaktsághoz''}

Az egzakt d.e.-k definíciójában kikötöttük, hogy $\grad G = (g,h)$, azaz
$\partial_1 G = g$ és $\partial_2 G = h$.

Ha $g,h \in D$ teljesül, akkor $G \in D^2$, vagyis a Young-tétel szerint,
$$\partial_{12}G = \partial_{21}G \implies \partial_2g = \partial_1 h$$

Tehát ekkor a $\partial_2 g = \partial_1 h$ tekinthető \emph{szükséges feltételként} ahhoz, hogy egzakt differenciálegyenlet legyen a megadott feladat. Az is igaz, hogy ez ``majdnem'' elégséges feltételnek is elég.

% TODO: multiplikátor módszer ($gm$, $hm$)

\subsection{Alternatív alak egzakt differenciálegyenletekre}

Az egzakt differenciálegyenlet definíciójában szereplő\footnote{
A könyvvel és a segédanyaggal ellentétben én itt $\varphi$ helyett $y$-al jelölöm a megoldás függvényt. Mivel ez a megjegyzés eleve a gyakorlatban használt, kicsit informális jelölésről szól, szerintem így jobban felismerhető a ``mindennapi'' alak.
}
$$y'(x) = -\frac{g(x,y(x))}{h(x,y(x))} \qquad (x \in \dom_y)$$
alakot szokás a következő formában is megadni:
$$\frac{dy}{dx} = -\frac{g(x,y)}{h(x,y)}$$
amiből átrendezéssel\footnote{
Az előadó szavaival élve: \emph{```Természetesen pusztán formai ``manipulációról'' van szó, de állapodjunk meg abban, hogy az előbbi szimbólum (``egyenlet'') ugyanazt fogja jelenteni, mint az egzakt egyenletet meghatározó egyenlőség.''}
} kapjuk, hogy
$$g(x,y)\,dx + h(x,y)\,dy = 0$$

Tehát ezzel a jelöléssel:
\vspace{-5pt}
$$(x^2 - y)\,dx - x\,dy = 0 \enspace \eqv \enspace y'(x) = - \frac{y(x)-x^2}{x} \qquad (x \in \dom_y)$$

\section{Rakéta (vagy függőleges hajítás) feladat}\label{sec:rocket-general}

\subsection{Feladat}

Függőlegesen fellövünk egy $m$ tömegű rakétát $v_0$ kezdősebességgel. Tegyük fel, hogy a mozgására két erő hat: a nehézségi erő (jelölje $\alpha$ a nehézségi gyorsulást), valamint a sebesség négyzetével arányos súrlódási erő (jelölje $\beta$ az arányossági tényezőt).

\emph{Mennyi ideig emelkedik a rakéta?}\footnote{Fontos megjegyezni, hogy a feladatot rakéta helyett lehet általános függőleges hajításként is felírni: egy $m$ tömegű testet felhajítunk (tökéletesen) függőlegesen $v_0$ kezdősebességgel. A fenti feltevések ugyanúgy érvényesülnek itt is. Egyes vizsgáztatóknál (értsd: Kovács tanár úr) ez a preferált felvázolása a feladatnak.}

\subsection{Newton II. törvénye (dinamika alaptörvénye)}

Newton II. törvénye\footnote{\href{https://hu.wikipedia.org/wiki/Newton_törvényei\#Newton_II._törvénye_–_a_dinamika_alaptörvénye}{Wikipédia: Newton II. törvénye}} alapján tudjuk, hogy egy test gyorsulása egyenesen arányos a rá ható erővel, és fordítottan arányos a test tömegével, azaz
$$ a = \frac F m$$

Vagy ugyanez a $p = m \cdot v$ impulzusból kifejezve:
\begin{equation}\label{eq:newton-ii}
F = \frac {dp} {dt} =\text{(ha $m$ nem függ $t$-től)} = m\cdot \frac {dv}{dt}\ \big(\equiv m\cdot v'(t)\big)
\end{equation}

\subsection{Megoldás}

A fenti paraméterekről az értelmezésükből következően tudjuk, hogy $m > 0, v_0 > 0, \alpha > 0$ és $\beta > 0$. Ismert továbbá a $v(0) = v_0$ \emph{kezdeti feltétel}.

Jelölje $v \in \R \to \R$ a sebesség-idő függvényt, amiről feltételezzük, hogy $v \in D$ és $0 \in \dom_v$.

A feladat szerint bármely $t \in \dom_v$ időpillanatban $\alpha \cdot m + \beta \cdot v^2(t)$ erő fog hatni a testre, aminek iránya ellentétes az emelkedésre. Ekkor mivel $m$ nem függ az időtől, a \eqref{eq:newton-ii} egyenlőség alapján:
\begin{equation}\label{eq:rocket-diff-cond}
    m \cdot v'(t) = -\alpha \cdot m - \beta \cdot v^2(t) \qquad (t \in \dom_v)
\end{equation}

Olyan $v$ függvényt keresünk tehát, amire a \eqref{eq:rocket-diff-cond} egyenlőség teljesül. Speciálisan, keressük azt a $T \in \dom_v$ időpillanatot, amire $v(T) = 0$ teljesül (ez lesz az a pont, ahol a rakéta befejezi az emelkedést, majd zuhanásba kezd). Átrendezve a \eqref{eq:rocket-diff-cond} kikötést $v'(t)$-re, majd a jobb oldalból $-\alpha$-t kiemelve kapjuk, hogy
\begin{equation}\label{eq:rocket-diff-cond-2}
    v'(t) = -\alpha \left(1 + \frac \beta {m\alpha} v^2(t)\right) \qquad (v \in \dom_v)
\end{equation}

\begingroup
\newcommand{\bma}{{\frac {\beta}{m\alpha}}}
\newcommand{\mab}{{\frac {m\alpha}{\beta}}}
\newcommand{\sbma}{{\sqrt{\bma}}}
\newcommand{\smab}{{\sqrt{\mab}}}

Vegyük észre, hogy ez egy szeparábilis d.e., a következő felbontással:
\begin{equation}\label{eq:rocket-sep}
    I := J := \R, \ g(x) := -\alpha,\ h(y) := 1 + \frac{\beta}{m\alpha}y^2 \qquad (x,y \in \R)
\end{equation}

Határozzuk meg ekkor $g$ és $1/h$ primitív függvényeit:
\begin{gather*}
    G(x) := \int g(x)\, dx = \int -\alpha\, dx = -\alpha x + c \quad (x \in \R,\, c \in \R) \\
    H(y) := \int \frac 1 {h(y)}\, dy = \int \frac 1 {1 + \bma y^2}\, dy = \smab \arctg\left(\sbma y\right) + d \quad (x \in \R,\, d \in \R)
\end{gather*}

Legyen $c := 0$ és $\displaystyle d := -\smab \arctg\left(\sbma v_0\right)$, ekkor összevonás után\footnote{A segédanyag se fejti ki részletesebben itt a $d$ érték ``felfedezését'', de persze a gyakorlaton látott módszer segítségével ez kideríthető (ld. következő szekció).}
\begin{gather*}
    G(x) = -\alpha x \qquad (x \in \R) \\
    H(y) = \smab \left( \arctg \left(\sbma y\right) - \arctg\left(\sbma v_0\right) \right) \qquad (y \in \R)
\end{gather*}

A \eqref{eq:sep-uni-proof-hg-cond} egyenlőségbe behelyettesítve:
\begin{gather*}
    H(v(t)) - G(t) = H(v_0) - G(0) \implies \\
    \smab \left(\arctg\left(\sbma v(t)\right) - \arctg\left(\sbma v_0\right)\right) + \alpha t = 0 \implies \\
    \arctg\left(\sbma v(t)\right) = -\sqrt{\frac {\beta\alpha} {m}} t + \arctg\left(\sbma v_0\right) \quad (t \in \R)
\end{gather*}

Megoldásnak keressük azt a $T \in \dom_v$-t, amire $v(T) = 0$, vagyis
\begin{gather*}
\arctg\left(\sbma \cdot v(T)\right) = \arctg(0) = 0 = - \sqrt{\frac {\beta\alpha} m} \cdot T + \arctg\left(\sbma \cdot v_0\right) \\
\implies T = \sqrt{\frac m {\beta \alpha}}  \arctg\left(\sbma \cdot v_0\right)
\end{gather*}

\subsubsection{Gyakorlaton látott módszer}

Induljunk ki itt is a \eqref{eq:rocket-sep} szeparábilis d.e.-ből, vagyis
\[
v'(t) = g(t) \cdot h(v(t)) = -\alpha \cdot \left(1 + \bma v^2(t)\right) \quad (t \in \R)
\]

Ekkor mivel $0 \notin \rng_h$, ezért:
\begin{gather}\label{eq:rocket-int-eq}
\frac{v'(t)}{h(v(t))} = g(t) \implies \int \frac{v'(t)}{h(v(t))} \, dt = \int g(t) \, dt
\end{gather}

Ekkor $g$ primitív függvénye könnyen meghatározható:
\begin{gather*}
    \int g(t) \, dt = \int -\alpha \, dt = -\alpha t + c \quad (t \in \R,\, c \in \R)
\end{gather*}

Továbbá a bal oldalt is megkapjuk könnyen a szokásos $u := v(t)$ behelyettesítéssel élve:
\begin{gather*}
    \int \frac {v'(t)}{h(v(t))} \, dt = \int \frac 1 {h(u)} \, du = \int \frac 1 {1 + \bma u^2} \, du = \smab \cdot \int \sbma \cdot \frac 1 {1 + \bma u^2} \, du \\
    = \smab \cdot \arctg\left(\sbma \cdot u\right) + d = \smab \cdot \arctg\left(\sbma \cdot v(t)\right) + d \qquad (d \in \R)
\end{gather*}

Mivel
\[
\left(\arctg\left(\sbma \cdot x\right)\right)' = \sbma \cdot \frac 1 {1 + \bma x^2}
\]

Helyettesítsünk vissza \eqref{eq:rocket-int-eq} egyenlőségbe, $c,d$-t összevonva egy $\tilde c \in \R$ változóba:
\begin{equation}\label{eq:rocket-tc}
\smab \cdot \arctg\left(\sbma \cdot v(t)\right) = -\alpha t + \tilde c \quad (t \in \R)
\end{equation}

Ekkor $t := 0$-val a kezdetiérték feltétel miatt meghatározható $\tilde c$:
\begin{gather*}
\smab \cdot \arctg\left(\sbma \cdot v(0)\right) = -\alpha \cdot 0 + \tilde c \implies \tilde c =
\smab \cdot \arctg\left(\sbma \cdot v_0\right)
\end{gather*}

Ekkor \eqref{eq:rocket-tc} egyenlőségben vonjuk ki $\tilde c$-t mindkét oldalból és emeljünk ki:
\[
\smab \left(\arctg\left(\sbma \cdot v(t)\right) - \arctg\left(\sbma \cdot v_0\right)\right) = -\alpha t \quad (t \in \R)
\]

Amiből\footnote{Ha szeretnénk, itt ki is fejezhetjük $v(t)$-t expliciten egy olyan (nyílt) intervallumon, ahol $\tg$ invertálható.}
\[
\arctg\left(\sbma \cdot v(t)\right) = - \sqrt{\frac {\beta\alpha} m} \cdot t + \arctg\left(\sbma \cdot v_0\right) \quad (t \in \R)
\]

Innen ugyanúgy kapjuk $T$-t, mint a fenti módszerben:
\begin{gather*}
\arctg\left(\sbma \cdot v(T)\right) = \arctg(0) = 0 = - \sqrt{\frac {\beta\alpha} m} \cdot T + \arctg\left(\sbma \cdot v_0\right) \\
\implies T = \sqrt{\frac m {\beta \alpha}}  \arctg\left(\sbma \cdot v_0\right)
\end{gather*}

\endgroup

\begin{comment}
\emph{Ötlet:} Próbáljunk meg konstruálni olyan függvényt, aminek a deriváltjában olyan osztó lesz, ami kiejti a \eqref{eq:rocket-diff-cond-2} egyenlőség jobb oldalán található zárójeles részt (azaz próbáljuk meg feloldani a $v^2$-en függést). Vegyük észre, hogy az $(\arctg)'(t) = \dfrac 1 {1 + t^2} \enspace (t \in \R)$ függvény valamilyen konstans szorzóval $t$-re egy jó kiindulópontnak tűnik.

Legyen tehát $\varphi(t) := \arctg(ct) \enspace (t \in \R)$, valamilyen $c > 0$ állandóval. Ekkor az összetett fv. deriváltja tétel alapján:
$$\varphi'(t) = c \cdot \frac 1 {1+(ct)^2} \quad (t \in \R)$$

{ % group for beta-alpha-m shortcuts
\newcommand{\sbma}{\sqrt{\dfrac \beta {m \alpha}}}
\newcommand{\bma}{\dfrac \beta {m \alpha}}
\newcommand{\bam}{\dfrac {\beta \alpha} m}

Speciálisan $c := \sbma$ választással,
$$\varphi'(t) = \sbma \cdot \frac 1 {1 + \bma \cdot t^2} \quad (t \in \R)$$

Vegyük ekkor a következő $F$ függvényt,
\begin{gather*}
F(t) := \varphi(v(t)) = \arctg\left(\sbma \cdot v(t)\right) \quad (t \in \dom_v) \implies \\[7pt]
F'(t) = \varphi'(v(t)) \cdot v'(t) = \sbma \cdot \frac{1}{1 + \bma \cdot v^2(t)} \cdot v'(t) \quad (t \in \dom_v)
\end{gather*}

Behelyettesítve \eqref{eq:rocket-diff-cond-2}-t $F'(t)$-be, bármely $t \in \dom_v$-re
\begin{align*}
    F'(t) &= \sbma \cdot \frac{1}{1 + \bma \cdot v^2(t)} \cdot -\alpha\left(1+\bma v^2(t)\right) \\
          &= \sbma \cdot -\alpha = -\sqrt{\bam}
\end{align*}

Legyen továbbá $G(t) := -\sqrt{\bam}\cdot t \quad (t \in \dom_v)$, ekkor nyilván $G'(t) = -\sqrt{\bam} \quad (t \in \dom-v)$.

Ekkor $\forall t \in \dom_v : F'(t) = G'(t)$, vagyis $(F-G)'(t) = 0 \quad (t \in \dom_v)$.

Mivel $\dom_v$ nyílt\footnote{
Vagyis az egész $\dom_v$ értelmezési tartományon értelmezhetőek így az $F',\, G'$ deriváltfüggvények.
}, így $F-G$ értéke mindenhol konstans lesz, azaz $F - G \equiv \kappa$ (kappa).

Ez alapján $F$ definíciójába visszahelyettesítve:
\begin{equation}\label{eq:rocket-phi-v-t}
    \varphi(v(t)) = F(t) = G + \kappa = -\sqrt{\bam}\cdot t + \kappa \quad (t \in \dom_v)
\end{equation}

Továbbá a $v(0) = v_0$ kezdeti feltétel és $\varphi(t) = \arctg\left(\sbma \cdot t\right)$ definíció szerint:
$$\kappa = \varphi(v(0)) = \varphi(v_0) = \arctg\left(\sbma \cdot v_0\right)$$

Most, hogy kifejeztük $\kappa$-t a feladat paraméterei szerint, megadhatjuk $\varphi(v(t))$-t is \eqref{eq:rocket-phi-v-t} alapján hasonlóan:
$$\varphi(v(t)) = \arctg\left(\sqrt{\bma} \cdot v(t)\right) = -\sqrt{\bam}\cdot t + \kappa = -\sqrt{\bam}\cdot t + \arctg\left(\sqrt{\bma} \cdot v_0\right)$$

Ekkor a paraméterekből és $t$-ből ki tudjuk fejezni az $\arctg$ függvényen keresztül $v(t)$ értékét. Speciálisan keressük $T \in \dom_v$-t, amiről tudjuk, hogy $v(T) = 0$.
\begin{align*}
    \varphi(0) &= \varphi(v(T)) \\
    \underbrace{\arctg(0)}_{=\,0} &= -\sqrt{\bam} \cdot T + \arctg\left(\sqrt{\bma}\cdot v_0\right) \\
    \sqrt{\bam}\cdot T &= \arctg\left(\sqrt{\bma}\cdot v_0\right) \\[3pt]
    T &= \sqrt{\frac{m}{\beta \alpha}} \cdot \arctg\left(\sqrt{\bma} \cdot v_0\right)
\end{align*}

Tehát a rakéta a $\displaystyle T = \sqrt{\frac{m}{\beta \alpha}} \cdot \arctg\left(\sqrt{\bma} \cdot v_0\right)$ időpillanatban fejezi be az emelkedést, azaz pontosan ennyi ideig fog emelkedni.

% TODO: ábrák

}

\subsection{Rakéta feladat szeparábilis differenciálegyenletként}

A felvezetésként látott megoldás a rakéta emelkedési idejének kiszámítására jelentősen rövidíthető ezekkel az ismeretekkel.

Emlékeztető a feladat modelljére:
\begin{equation}
    v'(t) = -\alpha \left(1 + \frac \beta {m\alpha} v^2(t)\right) \qquad (v \in \dom_v) \tag{\ref{eq:rocket-diff-cond-2}}
\end{equation}

Továbbá $v(0) = v_0$.

Ekkor alkalmazva a következő felbontást,
$$I := J := \R,\ g(x) := -\alpha,\ h(y) := 1 + \frac {\beta y^2}{m\alpha} \quad (x,y \in \R)$$
egy szeparábilis differenciálegyenletet kapunk. Továbbá $\tau := 0,\ \xi := v_0$. Ekkor:
$$G(x) := -\alpha x,\; H(y) := \sqrt{\frac{m\alpha}{\beta}}\cdot \left(\arctg\sqrt{\frac \beta {m\alpha}} \cdot y\right) \qquad (x,y \in \R)$$

Ekkor az előző bizonyítás során megfogalmazottak alapján, bármely $x \in \dom_v$-re,
\begin{align}
H(v(x)) - G(x) &= H(v_0) - G(0) \notag \\
H(v(x)) &= G(x) + H(v_0) - G(0) \notag \\
\sqrt{\frac{m\alpha} \beta}\arctg\left(\sqrt{\frac \beta {m\alpha}} v(x)\right) &= -\alpha x + \sqrt{\frac{m\alpha} \beta}\arctg\left(\sqrt{\frac \beta {m\alpha}} v_0\right) \label{eq:rocket-sep-mid} \\
\sqrt{\frac{m} {\beta\alpha}}\arctg\left(\sqrt{\frac \beta {m\alpha}} v(x)\right) &= \sqrt{\frac{m} {\beta\alpha}}\arctg\left(\sqrt{\frac \beta {m\alpha}} v_0\right) - x \notag \\
\arctg\left(\sqrt{\frac \beta {m\alpha}} v(x)\right) &= \arctg\left(\sqrt{\frac \beta {m\alpha}} v_0\right) - \sqrt{\frac {\beta\alpha} m} x \notag 
\end{align}

Legyen $U$ az a nyílt intervallum, amin
\begin{equation}\label{eq:rocket-sep-U}
\left|\arctg\left(\sqrt{\frac \beta {m\alpha}}v_0\right)-\sqrt{\frac{\beta\alpha}{m}}x\right| < \frac \pi 2
\end{equation}
teljesül. Ekkor minden $x \in U$-ra:
\begin{align}
\sqrt{\frac \beta {m\alpha}}v(x) &= \tg\left(\arctg\left(\sqrt{\frac \beta {m\alpha}} v_0\right) - \sqrt{\frac {\beta\alpha} {m}} x\right) \notag \\
v(x) &= \sqrt{\frac {m\alpha} \beta} \tg\left(\arctg\left(\sqrt{\frac \beta {m\alpha}} v_0\right) - \sqrt{\frac {\beta\alpha} {m}} x\right) \notag
\end{align}

Megoldásnak tehát keressük azt a $T \in \dom_v$-t, amire $v(T) = 0$. 

Felhasználva, hogy \eqref{eq:rocket-sep-U} miatt $\tg(x) = 0 \eqv x = 0 \enspace (x \in U)$, ki tudjuk fejteni $T$-t, ugyanis
\begin{align*}
v(T) = 0 &= \underbrace{\sqrt{\frac{m\alpha}{\beta}}}_{\ne\ 0} \tg \left(\arctg\left(\sqrt{\frac \beta {m\alpha}} v_0\right) - \sqrt{\frac {\beta\alpha} {m}}T\right) \\
0 &= \tg \left(\arctg\left(\sqrt{\frac \beta {m\alpha}} v_0\right) - \sqrt{\frac {\beta\alpha} {m}}T\right) \\
0 &= \arctg\left(\sqrt{\frac \beta {m\alpha}} v_0\right) - \sqrt{\frac {\beta\alpha} {m}}T \\
\sqrt{\frac {\beta\alpha} {m}}T &= \arctg\left(\sqrt{\frac {\beta} {m\alpha}}v_0\right) \\
T &= \sqrt{\frac{m} {\beta\alpha}} \arctg\left(\sqrt{\frac{\beta}{m\alpha}}v_0\right)
\end{align*}

Megjegyezzük, hogy a \ref{sec:sep-uni} tétel következtében $T$ valóban megegyezik a \ref{sec:rocket-general} szekcióban, kicsit más úton kapott megoldásunkkal.

Megjegyezzük azt is, hogy itt a pontos $v(x)$ függvény meghatározása nélkül is ki lehetett volna számolni a $T$ értékét (pl. \eqref{eq:rocket-sep-mid}-ben $v(x)$ helyett rögtön $0$-val, és $x$ helyett $T$-vel számolva), de így a teljes általános szeparábilis d.e. megoldási módszer bemutatásra került.
\end{comment}